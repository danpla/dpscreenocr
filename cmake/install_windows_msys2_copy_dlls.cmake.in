file(
    GET_RUNTIME_DEPENDENCIES
    EXECUTABLES "@CMAKE_BINARY_DIR@/@APP_FILE_NAME@.exe"
    DIRECTORIES "$ENV{MINGW_PREFIX}/bin"
    POST_INCLUDE_REGEXES "^$ENV{MINGW_PREFIX}/bin/.*"
    POST_EXCLUDE_REGEXES ".*"
    RESOLVED_DEPENDENCIES_VAR RESOLVED_DEPENDENCIES
    UNRESOLVED_DEPENDENCIES_VAR UNRESOLVED_DEPENDENCIES
)

if(UNRESOLVED_DEPENDENCIES)
    message(
        SEND_ERROR
        "Unresolved MSYS2 dependencies: ${UNRESOLVED_DEPENDENCIES}"
    )
endif()

file(
    COPY ${RESOLVED_DEPENDENCIES}
    DESTINATION "@CMAKE_BINARY_DIR@"
)
